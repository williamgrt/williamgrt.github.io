<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>基于 Raft 实现容错 kv 服务（Lab 3） - williamgrt&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="williamgrt&#039;s Blog"><meta name="msapplication-TileImage" content="/img/avatar.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="williamgrt&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="设计要求整个任务要求基于 Raft 构建一个可以容错的 Key&amp;#x2F;Value 存储服务。细分为如下两个具体的任务：  Part A：Key&amp;#x2F;value service without log compaction Part B：Key&amp;#x2F;value service with log compaction"><meta property="og:type" content="blog"><meta property="og:title" content="基于 Raft 实现容错 kv 服务（Lab 3）"><meta property="og:url" content="https://williamgrt.github.io/2021/01/25/kvraft/"><meta property="og:site_name" content="williamgrt&#039;s Blog"><meta property="og:description" content="设计要求整个任务要求基于 Raft 构建一个可以容错的 Key&amp;#x2F;Value 存储服务。细分为如下两个具体的任务：  Part A：Key&amp;#x2F;value service without log compaction Part B：Key&amp;#x2F;value service with log compaction"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://williamgrt.github.io/img/og_image.png"><meta property="article:published_time" content="2021-01-24T16:47:25.000Z"><meta property="article:modified_time" content="2021-04-03T04:16:56.962Z"><meta property="article:author" content="williamgrt"><meta property="article:tag" content="MIT 6.824"><meta property="article:tag" content="系统设计"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://williamgrt.github.io/2021/01/25/kvraft/"},"headline":"williamgrt's Blog","image":["https://williamgrt.github.io/img/og_image.png"],"datePublished":"2021-01-24T16:47:25.000Z","dateModified":"2021-04-03T04:16:56.962Z","author":{"@type":"Person","name":"williamgrt"},"description":"设计要求整个任务要求基于 Raft 构建一个可以容错的 Key&#x2F;Value 存储服务。细分为如下两个具体的任务：  Part A：Key&#x2F;value service without log compaction Part B：Key&#x2F;value service with log compaction"}</script><link rel="canonical" href="https://williamgrt.github.io/2021/01/25/kvraft/"><link rel="icon" href="/img/avatar.jpg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="williamgrt&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-01-24T16:47:25.000Z" title="2021-1-25 00:47:25">2021-01-25</time>发表</span><span class="level-item"><time dateTime="2021-04-03T04:16:56.962Z" title="2021-4-3 12:16:56">2021-04-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></span><span class="level-item">10 分钟读完 (大约1470个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">基于 Raft 实现容错 kv 服务（Lab 3）</h1><div class="content"><h2 id="设计要求"><a href="# 设计要求" class="headerlink" title="设计要求"></a>设计要求 </h2><p> 整个任务要求基于 Raft 构建一个可以容错的 Key/Value 存储服务。细分为如下两个具体的任务：</p>
<ul>
<li>Part A：Key/value service without log compaction</li>
<li>Part B：Key/value service with log compaction</li>
</ul>
<a id="more"></a>

<h2 id="Part-A"><a href="#Part-A" class="headerlink" title="Part A"></a>Part A</h2><h3 id="交互流程"><a href="# 交互流程" class="headerlink" title="交互流程"></a>交互流程 </h3><p> 整体的交互流程如下：</p>
<ul>
<li>Client 找到集群中的 Leader，发送操作命令 <code>Put/Get/Append</code> 给 Leader，并等待 Leader 返回执行的结果。</li>
<li>Leader 通过底层的 Raft 协议把命令日志复制到其他的节点上。</li>
<li>等到集群内超过半数的节点都完成了日志的复制，Leader 执行这个命令，并且将结果返回给 Client。</li>
</ul>
<p>在前面我们已经实现了一个可用的 Raft 协议，我们在这个任务中主要使用 Raft 提供的接口。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rf *Raft)</span> <span class="title">Start</span><span class="params">(command <span class="keyword">interface</span>&#123;&#125;)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">bool</span>)</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h3><p>Client 的设计采用了以下的思路：</p>
<ul>
<li>保证每个操作仅仅执行一次，因此需要一个唯一的编号表明每个客户端的操作。</li>
<li>保证客户端每次只发送一个请求给服务端，可以通过加锁实现。</li>
<li>记录当前服务端的 Leader 编号，下次访问的时候直接访问记录的 Leader，节省了寻找 Leader 的时间。</li>
</ul>
<p>Client 的结构设计如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Clerk <span class="keyword">struct</span> &#123;</span><br><span class="line">	servers []*labrpc.ClientEnd</span><br><span class="line">	serial   <span class="keyword">int</span></span><br><span class="line">	clientId <span class="keyword">int64</span></span><br><span class="line">	leaderId <span class="keyword">int</span></span><br><span class="line">	mu       sync.Mutex</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当 Client 向 Server 发送 RPC 请求时，需要给每个 RPC 请求一个唯一的编号，Server 根据 Client 编号和 RPC 编号验证当前指令是否已经执行过了，保证指令的唯一执行。</p>
<h3 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h3><p>Server 端接收到了 Client 发送的指令后，需要通过底层的 Raft 库完成以下的事情：</p>
<ol>
<li>主节点把命令复制到 Raft 日志中（通过 Raft 的 <code>Start</code> 函数），并且等待 Raft 日志已经在集群超过一半的机器上成功复制完成，并且完成最终的提交工作。</li>
<li>Server 接收到 Raft 库提交的日志，执行日志中的命令。</li>
</ol>
<p>为了保证整个系统的行为是线性一致性的，Server 端需要有一个在后台运行的 apply goroutine，接收 Raft 系统提交的日志，并且执行日志的内容。所有客户端发送的命令都必须提交到 Raft 系统中，等待复制过程结束了才能执行命令的操作。</p>
<blockquote>
<p>所有类型的操作都需要按照上面的过程执行，包括 <code>Get()</code> 操作，这种做法可以保证系统不会读到 KV 系统中的过期值。</p>
</blockquote>
<p>如果 Client 发送了命令之后，Server 端的主节点变了，那么该如何处理？根据 <a target="_blank" rel="noopener" href="https://thesquareplanet.com/blog/students-guide-to-raft/">Guide</a> 的提示：</p>
<blockquote>
<p>Once the operation at that index is sent to apply(), you can tell whether or not the client’s operation succeeded based on whether the operation that came up for that index is in fact the one you put there. If it isn’t, a failure has happened and an error can be returned to the client.</p>
</blockquote>
<p>我们可以通过 index 完成 Leader 变更的判断，具体的执行思路如下：</p>
<p>通过 <code>Start()</code> 的返回值，我们可以得到一个和该命令关联的 index。我们为每一个 index 创建一个 channel，用于返回 Raft 库在这个 index 上提交的命令。Client 在该 channel 上等待返回的命令，判断返回的命令和字节发送的命令是否相等。这会造成以下两个结果：</p>
<ol>
<li>相等。说明命令执行完毕，返回 <code>OK</code>。</li>
<li>不相等。说明主节点发生了变更，Client 需要重新发送命令给新的 Leader。</li>
</ol>
<h2 id="Part-B"><a href="#Part-B" class="headerlink" title="Part B"></a>Part B</h2><p>Part B 的任为根据 Raft 论文的内容实现基于内存的快照机制，需要阅读论文第 7 章了解整体的运行流程。</p>
<p>快照机制可以减少 Raft 系统日志的大小，这么做的好处有以下几点：</p>
<ol>
<li>减少了存储 Raft 快照需要的空间。</li>
<li>减少日志存储的数量，加快了 Raft 节点崩溃恢复的速度。</li>
</ol>
<h3 id="整体流程"><a href="# 整体流程" class="headerlink" title="整体流程"></a>整体流程 </h3><p> 快照机制的运行流程如下：</p>
<ol>
<li>复制状态机（此处是 Server）检查日志的大小，判断是否需要执行保存日志的操作。</li>
<li>如果需要执行保存日志的操作，Server 调用 Raft 库提供的接口保存快照，截断日志。</li>
<li>在系统启动的过程中，从快照恢复系统的初始状态。</li>
</ol>
<p>快照机制还存在一个问题：如果主节点需要通过 <code>ApplyEntries()</code> 发送自己的日志给从节点，但此时日志已经被截断，无法发送。为了解决这个问题，Raft 作者提出了一种新的 RPC 请求：<code>InstallSnapshot()</code>，用于发送主节点的快照，解决了主节点发送已被截断日志的问题。</p>
<h3 id="InstallSnapshot"><a href="#InstallSnapshot" class="headerlink" title="InstallSnapshot"></a>InstallSnapshot</h3><p>InstallSnapshot 的整体流程见下图。</p>


<p>在本项目的实现中，Snapshot 在一个 RPC 中全部传输完毕，不需要执行分块传输。</p>
<p>Raft 的 Snapshot 机制在快照大小比较小的时候，是一种比较有效的手段。但是，如果快照的大小过大（达到了 GB 级别，这种情况在实际应用中很常见），该如何处理？有以下可能的方法：</p>
<ul>
<li>把数据存储在磁盘上。</li>
<li>延迟删除 log 日志的内容。<br>这些思路可以参考作者在博士论文中的内容。</li>
</ul>
<h2 id="参考"><a href="# 参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.824/papers/raft-extended.pdf">extended Raft Paper</a></li>
<li><a target="_blank" rel="noopener" href="https://thesquareplanet.com/blog/students-guide-to-raft/">Student Guide</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>基于 Raft 实现容错 kv 服务（Lab 3）</p><p><a href="https://williamgrt.github.io/2021/01/25/kvraft/">https://williamgrt.github.io/2021/01/25/kvraft/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>williamgrt</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-01-25</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-04-03</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/MIT-6-824/">MIT 6.824</a><a class="link-muted mr-2" rel="tag" href="/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">系统设计</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/" alt="支付宝"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/01/02/mutex-implementation/"><span class="level-item">互斥锁的实现</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.jpg" alt="williamgrt"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">williamgrt</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>广州，中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">11</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/williamgrt" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/williamgrt"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/C/"><span class="level-start"><span class="level-item">C</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="level-start"><span class="level-item">分布式</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="level-start"><span class="level-item">数据库</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%B1%82%E8%81%8C/"><span class="level-start"><span class="level-item">求职</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"><span class="level-start"><span class="level-item">网络编程</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-24T16:47:25.000Z">2021-01-25</time></p><p class="title"><a href="/2021/01/25/kvraft/">基于 Raft 实现容错 kv 服务（Lab 3）</a></p><p class="categories"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-02T11:45:57.000Z">2021-01-02</time></p><p class="title"><a href="/2021/01/02/mutex-implementation/">互斥锁的实现</a></p><p class="categories"><a href="/categories/C/">C</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-22T16:12:52.000Z">2020-12-23</time></p><p class="title"><a href="/2020/12/23/redis-ev/">Redis 源码阅读：启动与事件循环</a></p><p class="categories"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-12T13:29:28.000Z">2020-12-12</time></p><p class="title"><a href="/2020/12/12/shardkv/">MIT 6.824 Lab 4（分布式 shard kv）</a></p><p class="categories"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-28T08:56:01.000Z">2020-11-28</time></p><p class="title"><a href="/2020/11/28/raft-lab/">如何实现一个 Raft 协议（Lab 2 总结）</a></p><p class="categories"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MIT-6-824/"><span class="tag">MIT 6.824</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Raft/"><span class="tag">Raft</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Redis/"><span class="tag">Redis</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/epoll/"><span class="tag">epoll</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="tag">并发编程</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8A%80%E6%9C%AF%E4%B9%A6%E7%B1%8D/"><span class="tag">技术书籍</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B7%B1%E4%BF%A1%E6%9C%8D/"><span class="tag">深信服</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%BA%90%E7%A0%81/"><span class="tag">源码</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/"><span class="tag">系统设计</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9D%A2%E7%BB%8F/"><span class="tag">面经</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="williamgrt&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 williamgrt</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>